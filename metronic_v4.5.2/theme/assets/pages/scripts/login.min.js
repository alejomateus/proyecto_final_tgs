var Login=function(){var e=function(){$(".login-form").validate({errorElement:"span",errorClass:"help-block",focusInvalid:!1,rules:{username:{required:!0},password:{required:!0},remember:{required:!1}},messages:{username:{required:"Username is required."},password:{required:"Password is required."}},invalidHandler:function(e,r){$(".alert-danger",$(".login-form")).show()},highlight:function(e){$(e).closest(".form-group").addClass("has-error")},success:function(e){e.closest(".form-group").removeClass("has-error"),e.remove()},errorPlacement:function(e,r){e.insertAfter(r.closest(".input-icon"))},submitHandler:function(e){e.submit()}}),$(".login-form input").keypress(function(e){return 13==e.which?($(".login-form").validate().form()&& $('#login-btn').click(),!1):void 0})},r=function(){$(".forget-form").validate({errorElement:"span",errorClass:"help-block",focusInvalid:!1,ignore:"",rules:{email:{required:!0,email:!0}},messages:{email:{required:"Email is required."}},invalidHandler:function(e,r){},highlight:function(e){$(e).closest(".form-group").addClass("has-error")},success:function(e){e.closest(".form-group").removeClass("has-error"),e.remove()},errorPlacement:function(e,r){e.insertAfter(r.closest(".input-icon"))},submitHandler:function(e){e.submit()}}),$(".forget-form input").keypress(function(e){return 13==e.which?($(".forget-form").validate().form()&&$(".forget-form").submit(),!1):void 0}),jQuery("#forget-password").click(function(){jQuery(".login-form").hide(),jQuery("#error_user").hide(),jQuery(".forget-form").show()}),jQuery("#back-btn").click(function(){jQuery(".login-form").show(),jQuery("#error-correo").hide(),jQuery(".forget-form").hide()})},i=function(){function e(e){if(!e.id)return e.text;var r=$('<span><img src="../assets/global/img/flags/'+e.element.value.toLowerCase()+'.png" class="img-flag" /> '+e.text+"</span>");return r}jQuery().select2&&$("#country_list").size()>0&&($("#country_list").select2({placeholder:'<i class="fa fa-map-marker"></i>&nbsp;Select a Country',templateResult:e,templateSelection:e,width:"auto",escapeMarkup:function(e){return e}}),$("#country_list").change(function(){$(".register-form").validate().element($(this))})),$(".register-form").validate({errorElement:"span",errorClass:"help-block",focusInvalid:!1,ignore:"",rules:{fullname:{required:!0},email:{required:!0,email:!0},address:{required:!0},city:{required:!0},country:{required:!0},username:{required:!0},password:{required:!0},rpassword:{equalTo:"#register_password"},tnc:{required:!0}},messages:{tnc:{required:"Please accept TNC first."}},invalidHandler:function(e,r){},highlight:function(e){$(e).closest(".form-group").addClass("has-error")},success:function(e){e.closest(".form-group").removeClass("has-error"),e.remove()},errorPlacement:function(e,r){"tnc"==r.attr("name")?e.insertAfter($("#register_tnc_error")):1===r.closest(".input-icon").size()?e.insertAfter(r.closest(".input-icon")):e.insertAfter(r)},submitHandler:function(e){e.submit()}}),$(".register-form input").keypress(function(e){return 13==e.which?($(".register-form").validate().form()&&$(".register-form").submit(),!1):void 0}),jQuery("#register-btn").click(function(){jQuery(".login-form").hide(),jQuery(".register-form").show()}),jQuery("#register-back-btn").click(function(){jQuery(".login-form").show(),jQuery(".register-form").hide()})};return{init:function(){e(),r(),i()}}}();jQuery(document).ready(function(){Login.init()});
$(function(){
  $('#mail-btn').click(function(){
               texto=$("#email").val();               
          envio(texto,"error-correo",function (resp){
      if(resp==0)
        {
            $.ajax({
                type:'POST',//TIPO DE PETICION PUEDE SER GET
			dataType:"json",//EL TIPO DE DATO QUE DEVUELVE PUEDE SER JSON/TEXT/HTML/XML
			url:"myajax.php",//DIRECCION DONDE SE ENCUENTRA LA OPERACION A REALIZAR
			data:{Op:'correo',correo:texto,leer:'xs'},//DATOS ENVIADOS PUEDE SER TEXT A TRAVEZ DE LA URL O PUEDE SER UN OBJETO	
                beforeSend: function(){//ACCION QUE SUCEDE ANTES DE HACER EL SUBMIT
                },success: function(response){//ACCION QUE SUCEDE DESPUES DE REALIZAR CORRECTAMENTE LA PETCION EL CUAL NOS TRAE UNA RESPUESTA
                           if(response.respuesta=="GOOD"){//MANDAMOS EL MENSAJE QUE NOS DEVUELVE EL RESPONSE
                //alert("El correo llegara en unos minutos");
                jQuery(".login-form").show();jQuery(".forget-form").hide();
                }
				else{
                }	          
            },
			error: function(){//SI OCURRE UN ERROR 
				alert('El servicio no esta disponible intentelo mas tarde');//MENSAJE EN CASO DE ERROR
			}
                         
		});  
            }
        });
    });
    $('#login-btn').click(function(){
               usuario=$("#username").val();               
               clave=$("#password").val();
               
               if(usuario!="" && clave !=""){
            $.ajax({
                type:'POST',//TIPO DE PETICION PUEDE SER GET
			dataType:"json",//EL TIPO DE DATO QUE DEVUELVE PUEDE SER JSON/TEXT/HTML/XML
			url:"myajax.php",//DIRECCION DONDE SE ENCUENTRA LA OPERACION A REALIZAR
			data:{Op:'login',usuario:usuario, clave:clave,leer:'xs'},//DATOS ENVIADOS PUEDE SER TEXT A TRAVEZ DE LA URL O PUEDE SER UN OBJETO	
                beforeSend: function(){//ACCION QUE SUCEDE ANTES DE HACER EL SUBMIT
                },success: function(response){//ACCION QUE SUCEDE DESPUES DE REALIZAR CORRECTAMENTE LA PETCION EL CUAL NOS TRAE UNA RESPUESTA
             /*   $("#username").val("");               
               $("#password").val("");    
               */ if(response.mensaje=="GOOD"){//MANDAMOS EL MENSAJE QUE NOS DEVUELVE EL RESPONSE
                    window.location.href = "index.php";                        }
				else{
                                    jQuery("#text-user").text("Usuario y/o contraseña incorrectos"); 
                                    jQuery("#error_user").show();  
                }	          
            },
			error: function(){//SI OCURRE UN ERROR 
				alert('El servicio no esta disponible intentelo mas tarde');//MENSAJE EN CASO DE ERROR
			}
                         
		});  
               }
               else{
                   jQuery("#text-user").text(" Ingrese un usuario y una contraseña "); 
                   jQuery("#error_user").show(); 
               }
    });
                function envio(texto,campo, my_callback){
            var resp = 5;
              $.ajax({
                type:'POST',//TIPO DE PETICION PUEDE SER GET
			dataType:"json",//EL TIPO DE DATO QUE DEVUELVE PUEDE SER JSON/TEXT/HTML/XML
			url:"myajax.php",//DIRECCION DONDE SE ENCUENTRA LA OPERACION A REALIZAR
			data:{tabla:'usuario',columnas:'*',Op:'wsaw',
                            condicion:"usur_nombre='"+texto+"'",leer:'leer'},//DATOS ENVIADOS PUEDE SER TEXT A TRAVEZ DE LA URL O PUEDE SER UN OBJETO	
                beforeSend: function(){//ACCION QUE SUCEDE ANTES DE HACER EL SUBMIT
                },success: function(response){//ACCION QUE SUCEDE DESPUES DE REALIZAR CORRECTAMENTE LA PETCION EL CUAL NOS TRAE UNA RESPUESTA

                if(response.mensaje=="GOOD"){//MANDAMOS EL MENSAJE QUE NOS DEVUELVE EL RESPONSE
                             resp=1; 
                             jQuery("#error-correo").show();
                                              }
				else{
                    resp= 0;             
                }	
            my_callback(resp);              
            },
			error: function(){//SI OCURRE UN ERROR 
			//	alert('El servicio no esta disponible intentelo mas tarde');//MENSAJE EN CASO DE ERROR
			}
                         
		});
               return resp;
            }
});
